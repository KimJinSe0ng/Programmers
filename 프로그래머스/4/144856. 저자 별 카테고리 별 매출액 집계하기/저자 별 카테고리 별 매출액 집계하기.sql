SELECT
    A.AUTHOR_ID,
    A.AUTHOR_NAME,
    B.CATEGORY,
    SUM(B.PRICE * S.SALES) AS 'TOTAL_SALES'
FROM
    BOOK_SALES S
JOIN
    BOOK B ON B.BOOK_ID = S.BOOK_ID
JOIN
    AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID
WHERE
    DATE_FORMAT(SALES_DATE, '%Y-%m') = '2022-01'
GROUP BY A.AUTHOR_ID, B.CATEGORY
ORDER BY A.AUTHOR_ID, B.CATEGORY DESC;

# WITH SALES AS (SELECT
#     *
# FROM
#     BOOK_SALES
# WHERE
#     DATE_FORMAT(SALES_DATE, '%Y-%m') = '2022-01'
# GROUP BY BOOK_ID)

# SELECT
#     A.AUTHOR_ID,
#     A.AUTHOR_NAME,
#     B.CATEGORY,
#     SUM(B.PRICE * S.SALES) AS 'TOTAL_SALES'
# FROM SALES S
# JOIN BOOK B ON B.BOOK_ID = S.BOOK_ID
# JOIN AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID
# GROUP BY A.AUTHOR_ID, B.CATEGORY
# ORDER BY A.AUTHOR_ID, B.CATEGORY DESC;
